
<div style="margin-top: 5%;" *ngIf="Loader" class=" text-center">
    <img  src="../../assets/loader.gif" alt="">
</div>
<!-- <app-createpost></app-createpost> -->
<div *ngIf="!Loader && allPosts">
    <div *ngFor=" let item of allPosts " class="row mt-md-2">
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class=" col-md-1">
                        <a
                            [href]="item.postUser.profileUrl ? 'http://localhost:2000'+item.postUser.profileUrl : 'http://localhost:2000/assets//images/userdefault.png'"><img
                                height="50" width="50" style="border-radius: 25px;object-fit: cover;"
                                [src]="item.postUser.profileUrl ? 'http://localhost:2000'+item.postUser.profileUrl : 'http://localhost:2000/assets/images/userdefault.png'"
                                ></a>
                    </div>
                    <div class="col-md-6 mx-2">
                        <span style="text-decoration: none; color: black;" class=""><span class="">
                                {{item.postUser.name}}</span></span>
                        <p title="Public">{{item.createdAt | date:'medium'}} <i class="fa fa-firefox"
                                aria-hidden="true"></i>
                        </p>
                    </div>
                    <div *ngIf="data._id == item.postUser._id" class="col-md-1 offset-md-3">
    
                        <div class="nav-item  dropstart mx-2">
                            <a style="font-size: 19px;" class="nav-link active text-dark" id="navbarDropdown"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fa fa-ellipsis-h" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" data-bs-toggle="modal" (click)="edit(item)"
                                        data-bs-target="#UpdatePost">Edit Post</a></li>
                                <li><a class="dropdown-item" data-bs-toggle="modal"
                                        data-bs-target="#createAccount">Update Profile
    
                                    </a></li>
                                <li><a class="dropdown-item" (click)="deletePost(item)">Delete Post</a></li>
    
                            </ul>
                        </div>
    
    
                    </div>
                </div>
                <div class="row">
    
                    <div class="col-md-12">
                        <p title="Public">{{item.status}}
                        </p>
                    </div>
                </div>
                <div class="row">
                    <a href="http://localhost:2000{{item.postUrl}}"><img height="460" width="100%"
                            style=" object-fit: contain;" src="http://localhost:2000{{item.postUrl}}" alt="hell"></a>
    
                </div>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <!-- <p (click)="onclick(item)"  data-bs-toggle="modal" data-bs-target="#createlike"> <i class="fa fa-thumbs-up text-primary" aria-hidden="true"></i> <span *ngIf="item.getlikes !='' " > You And {{item.likeCounts - 1}} Others  </span> <span *ngIf="item.getlikes =='' ">{{item.likeCounts}}</span> </p> -->
                        <p (click)="likeDialog(item)"> <i
                                class="fa fa-thumbs-up text-primary" aria-hidden="true"></i> {{ CheckUserLike(item.getlikes,data._id) &&
                            item.likeCounts ==1 ? 'You' : CheckUserLike(item.getlikes,data._id) && item.likeCounts > 1 ? 'You And
                            '+(item.likeCounts - 1)+' Others ' : item.likeCounts }} </p>
    
                    </div>
                    <div class="col-md-3 offset-md-3">
                        <!-- <p (click)="onclick(item)"  data-bs-toggle="modal" data-bs-target="#createlike"> <i class="fa fa-thumbs-up text-primary" aria-hidden="true"></i> <span *ngIf="item.getlikes !='' " > You And {{item.likeCounts - 1}} Others  </span> <span *ngIf="item.getlikes =='' ">{{item.likeCounts}}</span> </p> -->
                        <p (click)="oncomments(item)"> <span *ngIf=" item.commentCounts > 0 ">{{item.commentCounts}}
                                Comments</span> </p>
    
                    </div>
    
                </div>
    
                <hr>
                <div class="row">
                    <button [disabled]="likestarted" (click)="onlike(item._id,item.postUser._id)" [class.text-primary]="CheckUserLike(item.getlikes,data._id) "
                        class=" btn col"><i class="fa fa-thumbs-up" aria-hidden="true"></i> Like</button>
                    <button (click)="addcomment(item)" class="btn col"><i class="fa fa-comment" aria-hidden="true"></i>
                        Comment</button>
                    <button class="btn col"><i class="fa fa-share-alt" aria-hidden="true"></i> Share</button>
    
    
                </div>
                <hr>
                <div style="height: 110px;"  *ngIf="comment.includes(item._id)" class="row mt-md-5 overflow-auto ">
    
                    <div *ngFor="let comments of item.postcomment" class="row">
                        <div style="font-family: Segoe UI Historic, Segoe UI, Helvetica, Arial, sans-serif;"
                            class="d-flex">
                            <div class="mt-3 mx-2">
                                <a
                                    [href]="comments.usercomment_id.profileUrl ? 'http://localhost:2000'+comments.usercomment_id.profileUrl : 'http://localhost:2000/assets/images/userdefault.png'"><img
                                        height="35" width="35" style="border-radius: 17px; object-fit: cover;"
                                        [src]="comments.usercomment_id.profileUrl ? 'http://localhost:2000'+comments.usercomment_id.profileUrl : 'http://localhost:2000/assets/images/userdefault.png'"
                                        alt="hell">
                                </a>
                            </div>
                            <div  style="background-color: rgb(245, 242, 246); border-radius: 18px;height: 56px;"
                                class="px-2 mt-md-2">
                                <div style="justify-content: center;" class="d-flex ">
                                    <div class="p-1"> <span style="font-weight: bold;">{{comments.usercomment_id.name}}
                                        </span> <span *ngIf="data._id==comments.usercomment_id._id"
                                            (click)="deleteComment(comments._id,item._id)" class="ms-2"><i
                                                class="fa fa-times" aria-hidden="true"></i></span>
                                        <br>
                                        <span class="">{{comments.comment}} </span>
                                    </div>
                                </div>
                            </div>
    
                        </div>
                    </div>
                    <div  *ngIf="checkpostid==item._id"  class="row">
                        <div class="d-flex">
                            <div class=" mx-2 mt-2">
                                <a
                                    [href]="data.profileUrl ? 'http://localhost:2000'+data.profileUrl : 'http://localhost:2000/assets/images/userdefault.png'"><img
                                        height="35" width="35" style="border-radius: 17px; object-fit: cover;"
                                        [src]="data.profileUrl ? 'http://localhost:2000'+data.profileUrl : 'http://localhost:2000/assets/images/userdefault.png'"
                                        alt="hell">
                                </a>
                            </div>
                            <div  class="col-md-11 mt-md-2">
                                <div class="d-flex col-md-12">
                                    <div class="input-group">
                                        <input  (focus)="onFocus()" #comment (keyup.enter)="createcomment(comment,item)"
                                        style="border-top-left-radius:  23px; border-bottom-left-radius:  23px;" class="form-control" type="search"
                                        placeholder="Write a Comment..."  [(ngModel)]="addComments">
                                        <span (click)="commentToggleEmojiPicker()" style="border-top-right-radius:  23px; border-bottom-right-radius:  23px;" class=" input-group-text">ðŸ˜€</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <emoji-mart *ngIf="commentEmojiPicker" (emojiSelect)="addEmojiUPOnComment($event)"  class="emoji-mart"  set="twitter" emoji="point_up"  title="Add Your Emojis" [style]="{ position: 'absolute', bottom: '15%', right: '5%' }"></emoji-mart>
    
    
                </div>
            </div>
        </div>
        <div>
    
        </div>
    
    
    </div>
</div>

 
<!-- Update Post   Modal -->
<div class="modal fade mt-2" id="UpdatePost" tabindex="-1" aria-labelledby="UpdatePostLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="card-header">
                <div class="text-end">
                    <a class="text-secondary " #postUpdateModalClose data-bs-dismiss="modal"><i class="fa fa-times"></i></a>
                </div>
                <h4 class="text-center">Edit Post </h4><br>


                <!-- <div *ngIf="updatepostsuccess" class="alert alert-primary alert-dismissible fade show" role="alert">
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">

                    </button>
                    <strong>{{updatepostsuccess}}</strong>
                </div> -->

                <div *ngIf="updateposterr" class="alert alert-danger alert-dismissible fade show" role="alert">
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">

                    </button>
                    <strong>{{updateposterr.message?updateposterr.message:updateposterr}}</strong>
                </div>

            </div>
            <div class="modal-body">


                <div class="card-body p-3">

                    <form [formGroup]='UpdatePost' method="POST" id="UpdatePost" (submit)='onUpdatepost()'>

                        <div class="row">
                            <div class=" col-md-2">
                                <a
                                    [href]="data.profileUrl ? 'http://localhost:2000'+data.profileUrl : 'http://localhost:2000/assets/images/userdefault.png'"><img
                                        height="50" width="50" style="border-radius: 25px; object-fit: cover;"
                                        [src]="data.profileUrl ? 'http://localhost:2000'+data.profileUrl : 'http://localhost:2000/assets/images/userdefault.png'"
                                        alt="hell"></a>
                            </div>
                            <div class="col-md-6">
                                <span style="text-decoration: none; color: black;" class=""><span class="">
                                        {{data.name}}</span></span>
                                <p title="Public"> <i class="fa fa-firefox" aria-hidden="true"></i>
                                </p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="row">
                                <div class=" input-group">
                                    <input *ngIf="data" formControlName='status' class="form-control "
                                    type="text" name="status" id="status1"
                                    placeholder="What's on your mind , {{data.name.substr(0,7)}} ?" aria-label="Search" (focus)="onFocus()">
                                    <span (click)="updatePostToggleEmojiPicker()"  class=" input-group-text">ðŸ™‚</span>
                                </div>

                            </div>

                        </div>
                        <div class="my-4" *ngIf="updatesrc">
                            <img height="300" width="400" style="object-fit: cover;" [src]="updatesrc" alt="">
                        </div>
                        <div class="mb-3">
                            <div class="row">
                                <input formControlName='post' (change)="onFileUpdatePostChange($event)" accept='image/*'
                                    type="file" capture="capture" name="post" class="form-control col mx-1" id="post1">

                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="row">
                                <input style="border-radius: 12px;" type="text" name="updatepost" disabled
                                    placeholder="Add to Your Post" class="form-control form-control-lg col mx-1"
                                    id="updatepost">
                            </div>
                        </div>

                        <button type="submit" id="Edit" class="btn btn-primary form-control btn-block"> Edit
                            Post</button>

                    </form>
                </div>

            </div>
            <emoji-mart  *ngIf="updatePostEmojiPicker" (emojiSelect)="addEmojiUP($event)"  class="emoji-mart"  set="twitter" emoji="point_up"  title="Emojis" [style]="{ position: 'absolute', bottom: '2%', right: '2%',width:'220px',height:'420px' }"></emoji-mart>

        </div>
    </div>
</div>
